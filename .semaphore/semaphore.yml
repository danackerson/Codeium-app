
version: v1.0
name: MyPipeline
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
blocks:
  - name: 'Build and Test'
    task:
      jobs:
        - name: 'Build and Start App'
          commands:
            - checkout
            - echo "Installing dependencies..."
            - npm install
            - echo "Starting the Node.js application..."
            - node app.js 
            - echo "Waiting for the application to start..." 
            - sleep 5
            - echo "Testing if the application is up and running..."
            - curl -s http://localhost:3000/ | grep "Hello, Semaphore, Our build works Now!!"
            - kill %1